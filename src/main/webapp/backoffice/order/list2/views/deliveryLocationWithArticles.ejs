<!% this is of class DeliveryLocationWithArticlesDto %>
<% var deliveryLocation = this.entity %>
<% var articlesWithOrders = this.items %>
<% var countOrderItems = this.countOrderItems %>

<% 
// prepare array with all order ID's for this location. Will be used in delivery notification email
var orderIds = new Array();
for ( var i = 0; i < articlesWithOrders.length; i++ ) { 
	var articleWithOrders = articlesWithOrders[i];
	var orders = articleWithOrders.items;
	for ( var j = 0; j < orders.length; j++ ) { 
		var order = orders[j];
		orderIds.push(order.id);
	} 
} 
%>

<td class="deliveryLocationCell">
	<%= deliveryLocation.abbreviation %><br>
	<%= countOrderItems %> <br>
	<input type="button" class="delivery-notification-button" value="Notify"
		orderIds="<%= orderIds.join(",") %>"
	>
</td>

<td class="articlesCell">
<% for ( var i = 0; i < articlesWithOrders.length; i++ ) { %>
	<% var articleWithOrders = articlesWithOrders[i] %>
	<% var article = articleWithOrders.entity %>
	<% var orders = articleWithOrders.items %>
	<table class="articlesTable">
		<tr>
			<td class="articleCell" style="padding : 2px;">
				<%= article.name_cz %> - <%= orders.length %>
			</td>
			
			<td class="ordersCell">
			
				<table class="ordersTable">
	<% for ( var j = 0; j < orders.length; j++ ) { %>
		<% var order = orders[j] %>
					<tr>
						<td class="orderCell">
							<%= order.owner.firstName %> <%= order.owner.lastName %>
						</td>
					</tr>
	<% } %>
				</table>
			</td>
		</tr>
	</table>
<% } %>
</td>